<!doctype html>

<html lang="pl">
<head>
<title>Programowanie Gier 2D Mateusz J.</title>
  <meta charset="utf-8">
  <meta name="description" content="Zrealizowanie gry w ramach zadania Animacja 1.">
  <meta name="author" content="Mateusz Janiak">
</head>

<body>
    <a href="index.html">Wroc</a><br/>

    <canvas id="bubbleGame" width="800" height="600" style="border:2px solid #d3d3d3;"> </canvas><br />
    <script>
        // helper functions

        // generate rgb string from integer values
        function rgb(r, g, b){
            return "rgb("+r+","+g+","+b+")";
        }

        // arrow listener
        function keyCallback(event)
        {
            switch (event.key) {
                case "ArrowLeft":
                    refreshRect(-1)
                    break;
                case "ArrowRight":
                    refreshRect(1)
                    break;
            }
        }

        // refresh rectange image
        function refreshRect(sign)
        {
            const diff = 10;
            rectPositionX = rectPositionX + diff * sign;
            ctx.fillStyle = rectColor;
            rect = ctx.fillRect(rectPositionX, rectPositionY, rectWidth, rectHeight);
            ctx.fill();
            updateBubble(bulletPositionX, bulletPositionY, bulletRadius, bulletColor);
        }

        // create bullets params and define shot loop
        function startShooting()
        {
            updateBubble(bulletPositionX, bulletPositionY, bulletRadius, bulletColor);
        }

        // update bubble
        function updateBubble(x, y, r, color)
        {
            ctx.fillStyle = color;
            arc = ctx.arc(x, y, r, 0, 2 * Math.PI);
            ctx.fill();
        }

        // define canvas and create context
        var canvas = document.getElementById("bubbleGame");
        var ctx = canvas.getContext("2d");

        // define rectangle params
        const rectColor = rgb(231, 123, 132);
        const rectWidth = canvas.offsetWidth / 8.0;
        const rectHeight = canvas.offsetWidth / 40.0;
        const rectPositionY = canvas.offsetHeight - rectHeight;
        var rectPositionX = canvas.offsetWidth / 2.0 - rectWidth / 2.0;

        // create rectangle
        ctx.fillStyle = rectColor;
        rect = ctx.fillRect(rectPositionX, rectPositionY, rectWidth, rectHeight);
        ctx.stroke();

        // register events
        window.addEventListener('keydown', this.keyCallback, event)

        // set up shooter
        const bulletColor = rgb(0, 0, 180);
        const bulletRadius = rectHeight / 2.0;
        var bulletPositionX = rectPositionX + rectWidth / 2.0;
        var bulletPositionY = rectPositionY - bulletRadius;
        startShooting()

    </script>
</body>
</html>
